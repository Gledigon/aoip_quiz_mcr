<!DOCTYPE html>
<html lang="no" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' https://*.tawk.to https://cdnjs.cloudflare.com; img-src 'self' data: blob: https://*.tawk.to; connect-src 'self' https://*.tawk.to wss://*.tawk.to; frame-src https://*.tawk.to;">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    
    <title>Mikkelsens AoIP Quiz</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Logout Button -->
    <button onclick="AUTH.logout()" class="logout-btn">
        <i class="fas fa-sign-out-alt"></i> Logg ut
    </button>

    <!-- Theme Toggle -->
    <div id="theme-toggle" class="theme-toggle" title="Bytt tema">
        <i class="fas fa-moon"></i>
    </div>

    <!-- Chat Button -->
    <button id="startChat" onclick="CHAT.start()" class="chat-btn">
        <i class="fas fa-comments"></i> Start Chat
    </button>

    <!-- Main Content -->
    <div id="main-content" class="container">
        <!-- Rest of your existing content -->
        <!-- ... -->
    </div>

    <!-- Scripts -->
    <script src="utils.js"></script>
    <script src="quiz-config.js"></script>
    <script src="auth.js"></script>
    <script src="quiz-functions.js"></script>
    <script src="theme-toggle.js"></script>
    <script src="export-functions.js"></script>

    <!-- Tawk.to script will be loaded dynamically when needed -->
    <script>
    // Chat functionality
    const CHAT = {
        isLoaded: false,
        tawkId: '6769ef41af5bfec1dbe0cf3e/1ifqst6ms',
        
        start: function() {
            if (!this.isLoaded) {
                this.loadTawkTo();
            } else {
                Tawk_API.toggle();
            }
        },

        loadTawkTo: function() {
            var s1 = document.createElement("script"),
                s0 = document.getElementsByTagName("script")[0];
            s1.async = true;
            s1.src = 'https://embed.tawk.to/' + this.tawkId;
            s1.charset = 'UTF-8';
            s1.setAttribute('crossorigin', '*');
            s0.parentNode.insertBefore(s1, s0);
            this.isLoaded = true;

            // Update visitor name if groupName is filled
            const groupName = document.getElementById('groupName')?.value;
            if (groupName) {
                window.Tawk_API = window.Tawk_API || {};
                Tawk_API.visitor = {
                    name: groupName
                };
            }
        }
    };
    </script>
</body>
</html>
